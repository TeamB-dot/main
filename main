local TRASH_LINK = "https://raw.githubusercontent.com/TeamB-dot/main/refs/heads/main/main"

-- AutoExec speichern
local function setQueued(val)
    pcall(function()
        writefile("blackair_queue.txt", tostring(val))
    end)
end

local function serverHop()
    if getgenv().BlackAir and getgenv().BlackAir.AutoExec then
        setQueued(true)
    end
    game:GetService("TeleportService"):Teleport(game.PlaceId)
end

-- ============ ORIGINAL TRASH CAN SYSTEM ============

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

local folder = workspace:WaitForChild("Map")
    :WaitForChild("Deko")
    :WaitForChild("Muelleimer")
    :WaitForChild("Folder")

local currentIndex = 0

local function safeTeleport(pos)
    if Character and Character:FindFirstChild("HumanoidRootPart") then
        Character.HumanoidRootPart.CFrame = CFrame.new(pos + Vector3.new(0,3,0))
        task.wait(0.25)
    end
end

local function getNextRawContainer()
    for _, obj in ipairs(folder:GetChildren()) do
        if obj:IsA("Model") and obj.Name == "ContainerTonneS" then
            return obj
        end
    end
    return nil
end

local function processNextContainer()
    local container = getNextRawContainer()
    if not container then
        return false
    end

    currentIndex += 1
    container.Name = "ContainerTonneS" .. currentIndex

    local tpPos = nil
    if container.PrimaryPart then
        tpPos = container.PrimaryPart.Position
    else
        local basePart = container:FindFirstChildWhichIsA("BasePart")
        if basePart then
            tpPos = basePart.Position
        end
    end

    if not tpPos then
        warn("[Warn] Kein TP-Punkt:", container.Name)
        return true
    end

    safeTeleport(tpPos)

    local giveLoot = container:FindFirstChild("GiveLoot")
    if giveLoot and giveLoot:IsA("RemoteEvent") then
        giveLoot:FireServer()
        print("[Loot] Von", container.Name)
    else
        warn("[Warn] Kein GiveLoot Remote:", container.Name)
    end

    return true
end

while true do
    local hasMore = processNextContainer()
    if not hasMore then
        print("Alle Container fertig â†’ Auto Server Hop")
        serverHop()
        break
    end
    task.wait(0.05)
end
